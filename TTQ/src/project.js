System.register([],(function(){"use strict";return{execute:function(){System.register("project:///assets/script/data/constants.ts",["cc"],(function(e,t){var i,s,r,a,o,n;return e({BOARD_TYPE:void 0,GAME_STATE:void 0,GAME_EVENT:void 0,JUMP_STATE:void 0}),{setters:[function(e){i=e.Vec3}],execute:function(){cc._RF.push(window.module||{},"d9bbf8RNxZP/qHAzCKjmpIn","constants"),function(e){e[e.NORMAL=0]="NORMAL",e[e.SPRING=1]="SPRING",e[e.DROP=2]="DROP",e[e.GIANT=3]="GIANT",e[e.SPRINT=4]="SPRINT"}(s||(s={})),function(e){e[e.READY=1]="READY",e[e.PLAYING=2]="PLAYING",e[e.PAUSE=3]="PAUSE",e[e.OVER=4]="OVER"}(r||(r={})),function(e){e.RESTART="restart",e.REVIVE="revive",e.ADDSCORE="add-score",e.DYING="dying",e.HIDETIPS="hide-tips"}(a||(a={})),function(e){e[e.JUMPUP=1]="JUMPUP",e[e.FALLDOWN=2]="FALLDOWN",e[e.SPRINT=3]="SPRINT"}(o||(o={})),e("Constants",n=function e(){babelHelpers.classCallCheck(this,e)}),n.COEFF_POS_BALL=8/360,n.PLAYER_MAX_DOWN_FRAMES=40,n.MAX_SCORE=0,n.SCORE_BOARD_CENTER=2,n.SCORE_BOARD_NOT_CENTER=1,n.BOARD_INIT_POS=new i(0,10,0),n.BOARD_NUM=6,n.BOARD_NEW_INDEX=2,n.BOARD_HEIGTH=.25,n.BOARD_RADIUS=1.5,n.BOARD_HEIGTH_SCALE_DROP=.5,n.BOARD_RADIUS_SCALE_GIANT=2.8,n.BOARD_GAP=4.3,n.BOARD_GAP_SPRING=9,n.BOARD_GAP_SPRINT=192,n.BOARD_SCALE_GIANT=2.8,n.SCENE_MAX_OFFSET_X=3.5,n.BOARD_TYPE=s,n.BOARD_DROP_FRAMES=40,n.BOARD_DROP_STEP=.5,n.BOARD_RADIUS_CENTER=.35,n.BOARD_SPRING_FRAMES=10,n.BOARD_WAVE_FRAMES=16,n.BOARD_WAVE_INNER_START_FRAMES=8,n.BOARD_WAVE_INNER_STEP=.24,n.BOARD_WAVE_STEP=2.25,n.BOARD_MOVING_STEP=.03,n.SPRING_HEIGHT=.2,n.SPRING_HELIX_STEP=.5,n.SPRING_HELIX_STEP_SPIRNT=1.2,n.SPRING_TOP_STEP=.25,n.SPRING_TOP_STEP_SPRINT=.5,n.WAVE_OFFSET_Y=.065,n.CAMERA_INIT_POS=new i(0,15,22),n.CAMERA_INIT_ROT=new i(-11,0,0),n.CAMERA_MOVE_X_FRAMES=20,n.CAMERA_MOVE_Y_FRAMES=15,n.CAMERA_MOVE_Y_FRAMES_SPRING=23,n.CAMERA_MOVE_MINI_ERR=.02,n.CAMERA_OFFSET_Y=10,n.CAMERA_OFFSET_Y_SPRINT=15,n.BOARD_BUMP_FRAMES=10,n.BOARD_BUMP_STEP=[-.15,-.1,-.07,-.02,-.003,.003,.02,.07,.1,.15],n.GAME_STATE=r,n.GAME_EVENT=a,n.BALL_RADIUS=.5,n.BALL_JUMP_STATE=o,n.BALL_JUMP_FRAMES=20,n.BALL_JUMP_FRAMES_SPRING=27,n.BALL_JUMP_FRAMES_SPRINT=240,n.BALL_JUMP_STEP=[.8,.6,.5,.4,.3,.2,.15,.1,.05,.03],n.BALL_JUMP_STEP_SPRING=[1.2,.8,.6,.4,.3,.2,.15,.1,.05],n.BALL_JUMP_STEP_SPRINT=.8,n.BALL_SPRINT_STEP_Y=10,n.DIAMOND_NUM=10,n.DIAMOND_PIECE_NUM=10,n.DIAMOND_RADIUS=.3,n.DIAMOND_ROTATE_STEP_Y=1.5,n.DIAMOND_SCORE=1,n.DIAMOND_SCORE_AREA=.6,n.DIAMOND_SPRINT_SCORE_AREA=1,n.DIAMOND_SPRINT_STEP_Y=4,n.DIAMOND_START_FRAME=6,cc._RF.pop()}}})),System.register("project:///assets/script/game/audio-manager.ts",["cc"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.AudioClip,r=e.Component,a=e.AudioSourceComponent}],execute:function(){cc._RF.push(window.module||{},"52ff6Qg0MlJaaUpLNS1HPTJ","audio-manager"),d=i.ccclass,_=i.property,e("AudioManager",(o=d("AudioManager"),n=_(s),l=_(s),o((p=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"bg",u,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"click",h,babelHelpers.assertThisInitialized(i)),i.audioComp=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this.audioComp=this.getComponent(a)}},{key:"playSound",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?(this.audioComp.clip=this.bg,this.audioComp.play()):this.audioComp.stop()}},{key:"playClip",value:function(){this.audioComp.playOneShot(this.click)}}]),t}(r),u=babelHelpers.applyDecoratedDescriptor(p.prototype,"bg",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=babelHelpers.applyDecoratedDescriptor(p.prototype,"click",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=p))||c)),cc._RF.pop()}}})),System.register("project:///assets/script/game/ball.ts",["cc","../data/constants.ts","../utils/utils.ts","../utils/pool-manager.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A,R,g,m,S,E,T;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Node,a=e.Vec3,o=e.LabelComponent,n=e.Prefab,l=e.ParticleSystemComponent,c=e.AnimationComponent,p=e.CameraComponent},function(e){u=e.Constants},function(e){h=e.utils},function(e){d=e.PoolManager}],execute:function(){cc._RF.push(window.module||{},"900c8pQ81tCcrbRdvi9SxTB","ball"),S=i.ccclass,E=i.property,T=new a,e("Ball",(_=S("Ball"),b=E(n),P=E({type:n}),v=E({type:n}),_((A=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"diamondParticlePrefab",R,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"scoreAniPrefab",g,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"trail02Prefab",m,babelHelpers.assertThisInitialized(i)),i.currBoard=null,i.boardCount=0,i.jumpState=u.BALL_JUMP_STATE.JUMPUP,i.currBoardIdx=0,i.diffLevel=1,i.currJumpFrame=0,i.hasSprint=!1,i.isTouch=!1,i.touchPosX=0,i.movePosX=0,i.isJumpSpring=!1,i.boardGroupCount=0,i.trailNode=null,i._wpos=new a,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){u.game.node.on(r.EventType.TOUCH_START,this.onTouchStart,this),u.game.node.on(r.EventType.TOUCH_END,this.onTouchEnd,this),u.game.node.on(r.EventType.TOUCH_MOVE,this.onTouchMove,this),this.updateBall(),this.reset(),this.trailNode.active=!1}},{key:"onDestroy",value:function(){u.game.node.off(r.EventType.TOUCH_START,this.onTouchStart,this),u.game.node.off(r.EventType.TOUCH_END,this.onTouchEnd,this),u.game.node.off(r.EventType.TOUCH_MOVE,this.onTouchMove,this)}},{key:"update",value:function(e){if(u.game.state===u.GAME_STATE.PLAYING){var t=u.game.boardManager,i=t.getBoardList();if(this.jumpState===u.BALL_JUMP_STATE.SPRINT){this.currJumpFrame>u.BALL_JUMP_FRAMES_SPRINT&&(this.jumpState=u.BALL_JUMP_STATE.JUMPUP,this.isJumpSpring=!1,this.currJumpFrame=0,this.hasSprint=!1,t.clearDiamond()),this.currJumpFrame++;for(var s=t.getDiamondSprintList(),r=0;r<u.DIAMOND_NUM;r++)Math.abs(this.node.position.y-s[r].position.y)<=u.DIAMOND_SPRINT_SCORE_AREA&&Math.abs(this.node.position.x-s[r].position.x)<=u.DIAMOND_SPRINT_SCORE_AREA&&(u.game.addScore(u.DIAMOND_SCORE),this.showScore(u.DIAMOND_SCORE),u.game.ball.playDiamondParticle(this.node.position),s[r].active=!1);this.setPosY(),this.setPosX(),this.touchPosX=this.movePosX;var a=this.node.position.y+u.CAMERA_OFFSET_Y_SPRINT;u.game.cameraCtrl.setOriginPosY(a)}else{for(var o=this.currBoardIdx+1;o>=0;o--){var n=i[o],c=this.node.position,p=i[o].node.position;if(Math.abs(c.x-p.x)<=i[o].getRadius()&&Math.abs(c.y-(p.y+u.BOARD_HEIGTH))<=u.DIAMOND_SCORE_AREA&&i[o].checkDiamond(this.node.position.x),this.jumpState===u.BALL_JUMP_STATE.FALLDOWN){if(this.currJumpFrame>u.PLAYER_MAX_DOWN_FRAMES||this.currBoard.node.position.y-this.node.position.y>u.BOARD_GAP+u.BOARD_HEIGTH){var h=this.trailNode.getComponentInChildren(l);return h.stop(),h.node.active=!1,void u.game.gameDie()}if(this.isOnBoard(n)){this.currBoard=n,this.currBoardIdx=o,this.activeCurrBoard();break}}}this.currJumpFrame++,this.jumpState===u.BALL_JUMP_STATE.JUMPUP&&(this.isJumpSpring&&this.currJumpFrame>=u.BALL_JUMP_FRAMES_SPRING?(this.jumpState=u.BALL_JUMP_STATE.FALLDOWN,this.currJumpFrame=0):!this.isJumpSpring&&this.currJumpFrame>=u.BALL_JUMP_FRAMES&&(this.jumpState=u.BALL_JUMP_STATE.FALLDOWN,this.currJumpFrame=0)),this.setPosY(),this.setPosX(),this.currBoard.type!==u.BOARD_TYPE.SPRINT&&u.game.cameraCtrl.setOriginPosX(this.node.position.x),this.touchPosX=this.movePosX}this.setTrailPos()}}},{key:"onTouchStart",value:function(e,t){this.isTouch=!0,this.touchPosX=e.getLocation().x,this.movePosX=this.touchPosX}},{key:"onTouchMove",value:function(e,t){this.movePosX=e.getLocation().x}},{key:"onTouchEnd",value:function(e,t){this.isTouch=!1}},{key:"reset",value:function(){this.boardCount=0,this.diffLevel=1,T.set(u.BOARD_INIT_POS),T.y+=u.BALL_RADIUS+u.BOARD_HEIGTH/2-.001,this.node.setPosition(T),this.node.eulerAngles=new a,this.currJumpFrame=0,this.jumpState=u.BALL_JUMP_STATE.FALLDOWN,this.hasSprint=!1,this.currBoardIdx=0,this.show(),this.playTrail(),this.setTrailPos()}},{key:"updateBall",value:function(){this.trailNode=d.instance.getNode(this.trail02Prefab,this.node.parent)}},{key:"show",value:function(){this.node.active=!0}},{key:"hide",value:function(){this.node.active=!1}},{key:"activeCurrBoard",value:function(){var e=this.node.position,t=this.currBoard.node.position,i=this.currBoard.type,s=t.y+u.BALL_RADIUS+this.currBoard.getHeight()/2-.01;if(this.node.setPosition(e.x,s,e.z),this.currJumpFrame=0,i===u.BOARD_TYPE.SPRINT?(this.jumpState=u.BALL_JUMP_STATE.SPRINT,u.game.cameraCtrl.setOriginPosX(t.x)):this.jumpState=u.BALL_JUMP_STATE.JUMPUP,!this.currBoard.isActive){this.currBoard.isActive=!0;var r=u.SCORE_BOARD_NOT_CENTER;(i!==u.BOARD_TYPE.NORMAL&&i!==u.BOARD_TYPE.DROP||Math.abs(e.x-t.x)<=u.BOARD_RADIUS_CENTER)&&(r=u.SCORE_BOARD_CENTER),u.game.addScore(r),this.showScore(r),this.boardCount++,5===this.boardCount&&u.game.node.emit(u.GAME_EVENT.HIDETIPS),this.diffLevel+=r/2;for(var a=this.currBoardIdx-u.BOARD_NEW_INDEX;a>0;a--)this.newBoard()}this.isJumpSpring=i===u.BOARD_TYPE.SPRING,this.currBoard.setBump(),this.currBoard.setWave(),i!=u.BOARD_TYPE.SPRING&&i!=u.BOARD_TYPE.SPRINT||this.currBoard.setSpring();var o=u.game.boardManager.getBoardList();if(i===u.BOARD_TYPE.DROP)for(var n=0;n<this.currBoardIdx;n++)o[n].setDrop();var l=t.y+u.CAMERA_OFFSET_Y;u.game.cameraCtrl.setOriginPosY(l),u.game.cameraCtrl.preType=i}},{key:"newBoard",value:function(){var e=u.BOARD_TYPE.NORMAL;if(this.boardGroupCount<=0){var t=h.getDiffCoeff(this.diffLevel,1,10),i=Math.random()*t;i<4.2?(e=u.BOARD_TYPE.NORMAL,this.boardGroupCount=2):i<=5.5?(e=u.BOARD_TYPE.GIANT,this.boardGroupCount=3):i<=6.2?(e=u.BOARD_TYPE.SPRING,Math.random()>.5&&(this.boardGroupCount=2)):i<=7?(e=u.BOARD_TYPE.DROP,this.boardGroupCount=3):i<=7.5&&!1===this.hasSprint?(e=u.BOARD_TYPE.SPRINT,this.hasSprint=!0):e=u.BOARD_TYPE.NORMAL}this.boardGroupCount--,u.game.boardManager.newBoard(e,this.diffLevel)}},{key:"showScore",value:function(e){var t=d.instance.getNode(this.scoreAniPrefab,cc.find("Canvas/resultUI")),i=new a,s=u.game.cameraCtrl.node.getComponent(p);this.node.getWorldPosition(this._wpos),cc.pipelineUtils.WorldNode3DToLocalNodeUI(s,this._wpos,cc.find("Canvas/resultUI"),i),i.x+=50,t.setPosition(i),t.getComponentInChildren(o).string="+".concat(e);var r=t.getComponent(c);r.once("finished",(function(){d.instance.putNode(t)})),r.play()}},{key:"setPosX",value:function(){if(this.isTouch&&this.touchPosX!==this.movePosX)if(T.set(this.node.position),this.jumpState===u.BALL_JUMP_STATE.SPRINT){var e=(this.movePosX-this.touchPosX)*u.COEFF_POS_BALL;this.node.setPosition(T.x+e,T.y,T.z),T.set(this.node.position),e=T.x;var t=1.3*u.SCENE_MAX_OFFSET_X,i=this.currBoard.node.position;e>i.x+t?this.node.setPosition(i.x+t,T.y,T.z):e<this.currBoard.node.position.x-t&&this.node.setPosition(i.x-t,T.y,T.z)}else{var s=(this.movePosX-this.touchPosX)*u.COEFF_POS_BALL;this.node.setPosition(T.x+s,T.y,T.z)}}},{key:"setPosY",value:function(){T.set(this.node.position),this.jumpState===u.BALL_JUMP_STATE.JUMPUP?(this.isJumpSpring?T.y+=u.BALL_JUMP_STEP_SPRING[Math.floor(this.currJumpFrame/3)]:T.y+=u.BALL_JUMP_STEP[Math.floor(this.currJumpFrame/2)],this.node.setPosition(T)):this.jumpState===u.BALL_JUMP_STATE.FALLDOWN?(this.currBoard.type===u.BOARD_TYPE.SPRING?this.currJumpFrame<u.BALL_JUMP_FRAMES_SPRING?T.y-=u.BALL_JUMP_STEP_SPRING[Math.floor((u.BALL_JUMP_FRAMES_SPRING-this.currJumpFrame-1)/3)]:T.y-=u.BALL_JUMP_STEP_SPRING[0]:this.currJumpFrame<u.BALL_JUMP_FRAMES?T.y-=u.BALL_JUMP_STEP[Math.floor((u.BALL_JUMP_FRAMES-this.currJumpFrame-1)/2)]:T.y-=u.BALL_JUMP_STEP[0],this.node.setPosition(T)):this.jumpState===u.BALL_JUMP_STATE.SPRINT&&(T.y+=u.BALL_JUMP_STEP_SPRINT,this.node.setPosition(T),this.currJumpFrame>=u.DIAMOND_START_FRAME+20&&this.currJumpFrame<=u.BALL_JUMP_FRAMES_SPRINT-50&&this.currJumpFrame%Math.floor(u.DIAMOND_SPRINT_STEP_Y/u.BALL_JUMP_STEP_SPRINT)==0&&u.game.boardManager.newDiamond())}},{key:"isOnBoard",value:function(e){var t=this.node.position,i=e.node.position,s=Math.abs(t.x-i.x),r=t.y-i.y;if(s<=e.getRadius()){if(r>=0&&r<=u.BALL_RADIUS+e.getHeight()/2)return!0;if(this.isJumpSpring&&this.currJumpFrame>=u.BALL_JUMP_FRAMES_SPRING){if(Math.abs(r)<u.BALL_JUMP_STEP_SPRING[0])return!0}else if(!this.isJumpSpring&&this.currJumpFrame>=u.BALL_JUMP_FRAMES&&Math.abs(r)<u.BALL_JUMP_STEP[0])return!0}return!1}},{key:"revive",value:function(){this.currBoardIdx--,this.currBoard.type===u.BOARD_TYPE.SPRINT&&(this.currBoardIdx++,this.currBoard=u.game.boardManager.getBoardList()[this.currBoardIdx]),this.currBoard.revive();var e=this.currBoard.node.position.clone();e.y+=u.BALL_RADIUS+this.currBoard.getHeight()/2-.001,this.node.setPosition(e),this.node.eulerAngles=new cc.Vec3(0,0,0),this.currJumpFrame=0,this.show();var t=this.currBoard.node.position.y+u.CAMERA_OFFSET_Y;u.game.cameraCtrl.setOriginPosX(e.x),u.game.cameraCtrl.setOriginPosY(t),this.playTrail(),this.setTrailPos()}},{key:"playDiamondParticle",value:function(e){var t=this,i=d.instance.getNode(this.diamondParticlePrefab,this.node.parent);i.setPosition(e);var s=i.getComponent(l);s.play();this.schedule((function e(){s.isPlaying||(d.instance.putNode(i),t.unschedule(e))}),.1)}},{key:"playTrail",value:function(){this.trailNode.active=!0,this.trailNode.getComponentInChildren(l).play()}},{key:"setTrailPos",value:function(){var e=this.node.position;this.trailNode.setPosition(e.x,e.y-.1,e.z)}}]),t}(s),R=babelHelpers.applyDecoratedDescriptor(A.prototype,"diamondParticlePrefab",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=babelHelpers.applyDecoratedDescriptor(A.prototype,"scoreAniPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=babelHelpers.applyDecoratedDescriptor(A.prototype,"trail02Prefab",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=A))||f)),cc._RF.pop()}}})),System.register("project:///assets/script/game/board-manager.ts",["cc","../data/constants.ts","../utils/utils.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Prefab,a=e.instantiate,o=e.Vec3},function(e){n=e.Constants},function(e){l=e.utils}],execute:function(){cc._RF.push(window.module||{},"2a0a0QivvtEZodpOZ79qMFb","board-manager"),P=i.ccclass,v=i.property,f=new o,A=new o,e("BoardManager",(c=P("BoardManager"),p=v(r),u=v(r),c((d=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"boardPrefab",_,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"diamondPrefab",b,babelHelpers.assertThisInitialized(i)),i.diamondSprintList=[],i.diamondCenterX=0,i._boardList=[],i._boardInsIdx=0,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this.initBoard(),this.initDiamond()}},{key:"reset",value:function(){this._boardInsIdx=0;for(var e,t=n.BOARD_INIT_POS.clone(),i=n.BOARD_TYPE.NORMAL,s=0;s<n.BOARD_NUM;s++)(e=this._boardList[s]).reset(i,t,1),t=this.getNextPos(e,1);if((e=this._boardList[0]).isActive=!0,n.game.ball.currBoard=e,this.diamondSprintList[0])for(var r=0;r<n.DIAMOND_NUM;r++)this.diamondSprintList[r].active=!1}},{key:"initBoard",value:function(){for(var e=0;e<n.BOARD_NUM;e++){var t=a(this.boardPrefab);t.name=this._boardInsIdx.toString(),this._boardInsIdx++,this.node.addChild(t);var i=t.getComponent("Board");this._boardList.push(i)}this.reset()}},{key:"newBoard",value:function(e,t){var i=this.getNextPos(this._boardList[n.BOARD_NUM-1],t,f),s=this._boardList[n.BOARD_NUM-1].type,r=this._boardList.shift();e===n.BOARD_TYPE.SPRINT&&(this.diamondCenterX=i.x,this.setDiamond(i)),s===n.BOARD_TYPE.SPRINT?r.reset(e,i,0):r.reset(e,i,t),r.name=this._boardInsIdx.toString(),this._boardInsIdx++,this._boardList.push(r)}},{key:"getNextPos",value:function(e,t,i){var s=i?i.set(e.node.position):e.node.position.clone(),r=l.getDiffCoeff(t,1,2);return s.x=(Math.random()-.5)*n.SCENE_MAX_OFFSET_X*r,e.type===n.BOARD_TYPE.SPRINT&&(s.y+=n.BOARD_GAP_SPRINT,s.x=e.node.position.x),e.type===n.BOARD_TYPE.SPRING?s.y+=n.BOARD_GAP_SPRING:s.y+=n.BOARD_GAP,s}},{key:"initDiamond",value:function(){for(var e=0;e<n.DIAMOND_NUM;e++)this.diamondSprintList[e]=a(this.diamondPrefab),this.node.addChild(this.diamondSprintList[e]),this.diamondSprintList[e].active=!1}},{key:"setDiamond",value:function(e){var t=e.clone();t.y+=n.BALL_JUMP_STEP_SPRINT*n.DIAMOND_START_FRAME;for(var i=0;i<n.DIAMOND_NUM;i++)this.setNextDiamondPos(t),this.diamondSprintList[i].setPosition(t),this.diamondSprintList[i].active=!0}},{key:"newDiamond",value:function(){A.set(this.diamondSprintList[n.DIAMOND_NUM-1].position),this.setNextDiamondPos(A);var e=this.diamondSprintList.shift();e.setPosition(A),e.active=!0,this.diamondSprintList.push(e)}},{key:"clearDiamond",value:function(){for(var e=0;e<n.DIAMOND_NUM;e++)this.diamondSprintList[e].active=!1}},{key:"setNextDiamondPos",value:function(e){e.y+=n.DIAMOND_SPRINT_STEP_Y,e.x+=1.5*(Math.random()-.5),e.x>this.diamondCenterX+n.SCENE_MAX_OFFSET_X?e.x=this.diamondCenterX+n.SCENE_MAX_OFFSET_X:e.x<this.diamondCenterX-n.SCENE_MAX_OFFSET_X&&(e.x=this.diamondCenterX-n.SCENE_MAX_OFFSET_X)}},{key:"getBoardList",value:function(){return this._boardList}},{key:"getDiamondSprintList",value:function(){return this.diamondSprintList}}]),t}(s),_=babelHelpers.applyDecoratedDescriptor(d.prototype,"boardPrefab",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=babelHelpers.applyDecoratedDescriptor(d.prototype,"diamondPrefab",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=d))||h)),cc._RF.pop()}}})),System.register("project:///assets/script/game/camera-ctrl.ts",["cc","../data/constants.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_;return e({_dec:void 0,_dec2:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Node,a=e.Vec3},function(e){o=e.Constants}],execute:function(){cc._RF.push(window.module||{},"b5204GgQaBDNqMtOdI4KDJl","camera-ctrl"),h=i.ccclass,d=i.property,_=new a,e("CameraCtrl",(n=h("CameraCtrl"),l=d(r),n((p=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"planeNode",u,babelHelpers.assertThisInitialized(i)),i.preType=o.BOARD_TYPE.NORMAL,i._originPos=new a,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){this._originPos.set(o.CAMERA_INIT_POS),this.setPosition(this._originPos),this.node.eulerAngles=o.CAMERA_INIT_ROT}},{key:"setOriginPosX",value:function(e){this._originPos.x=e}},{key:"setOriginPosY",value:function(e){this._originPos.y=e}},{key:"update",value:function(){if(_.set(this.node.position),_.x!==this._originPos.x||_.y!==this._originPos.y){if(Math.abs(_.x-this._originPos.x)<=o.CAMERA_MOVE_MINI_ERR)_.x=this._originPos.x,this.setPosition(_);else{var e=this._originPos.x-_.x;_.x+=e/o.CAMERA_MOVE_X_FRAMES,this.setPosition(_)}if(_.set(this.node.position),Math.abs(_.y-this._originPos.y)<=o.CAMERA_MOVE_MINI_ERR)_.y=this._originPos.y,this.setPosition(_);else{var t=this._originPos.y-_.y;this.preType===o.BOARD_TYPE.SPRING?(_.y+=t/o.CAMERA_MOVE_Y_FRAMES_SPRING,this.setPosition(_)):(_.y+=t/o.CAMERA_MOVE_Y_FRAMES,this.setPosition(_))}}}},{key:"reset",value:function(){this._originPos.set(o.CAMERA_INIT_POS),this.setPosition(this._originPos)}},{key:"setPosition",value:function(e){this.node.setPosition(e);var t=e.y-27;this.planeNode.setPosition(e.x,t,-100)}}]),t}(s),u=babelHelpers.applyDecoratedDescriptor(p.prototype,"planeNode",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=p))||c)),cc._RF.pop()}}})),System.register("project:///assets/script/game/board.ts",["cc","../data/constants.ts","../utils/utils.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A,R,g,m,S,E,T,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Vec3,a=e.Prefab,o=e.instantiate,n=e.ModelComponent,l=e.Color},function(e){c=e.Constants},function(e){p=e.utils}],execute:function(){cc._RF.push(window.module||{},"bb50aLcTl1FbpB7Hy0H/DT9","board"),E=i.ccclass,T=i.property,D=new r,e("Board",(u=E("Board"),h=T(a),d=T({type:a}),_=T({type:a}),b=T({type:a}),P=T({type:a}),u((f=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(a))),babelHelpers.initializerDefineProperty(i,"diamondPrefab",A,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"centerPrefab",R,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"wavePrefab",g,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"springTopPrefab",m,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"springHelixPrefab",S,babelHelpers.assertThisInitialized(i)),i.isActive=!1,i.diamondList=[],i.type=c.BOARD_TYPE.NORMAL,i.wave=null,i.waveInner=null,i.waveOriginScale=new r,i.currWaveFrame=0,i.currSpringFrame=0,i.currBumpFrame=c.BOARD_BUMP_FRAMES,i.springTop=null,i.springHelix=null,i.springHelixOriginScale=new r,i.center=null,i.isMovingRight=!0,i.hasDiamond=!1,i.isMoving=!1,i.posBeforeDrop=new r,i.originScale=new r,i.currDropFrame=c.BOARD_DROP_FRAMES,i._game=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){this.originScale.set(this.node.scale),this.initCenter(),this.initWave(),this.initSpring(),this.initDiamond()}},{key:"update",value:function(){this.effectBump(),this.effectWave(),this.type!==c.BOARD_TYPE.SPRING&&this.type!==c.BOARD_TYPE.SPRINT||this.effectSpring(),this.effectDrop(),this.effectMove(),this.hasDiamond&&this.effectDiamondRotate()}},{key:"reset",value:function(e,t,i){if(this.isActive=!1,this.type=e,this.node.setPosition(t),this.isMoving=!1,this.type!==c.BOARD_TYPE.NORMAL&&this.type!==c.BOARD_TYPE.DROP&&this.type!==c.BOARD_TYPE.SPRING||(this.isMoving=this.setMove(i)),this.type===c.BOARD_TYPE.GIANT?this.node.setScale(this.originScale.x*c.BOARD_SCALE_GIANT,this.originScale.y,this.originScale.z):this.type===c.BOARD_TYPE.DROP?(this.node.setScale(this.originScale.x,this.originScale.y*c.BOARD_HEIGTH_SCALE_DROP,this.originScale.z),this.posBeforeDrop.set(this.node.position)):this.node.setScale(this.originScale),this.springTop.active=!1,this.type===c.BOARD_TYPE.SPRING&&(this.springHelix.active=!0,this.springTop.active=!0,this.setSpringPos()),this.type===c.BOARD_TYPE.SPRINT&&(this.springHelix.active=!0,this.springTop.active=!0,this.setSpringPos()),this.hasDiamond=!1,this.diamondList[0]){for(var s=0;s<5;s++)this.diamondList[s].active=!1;if(this.type===c.BOARD_TYPE.GIANT)for(var r=0;r<5;r++)this.diamondList[r].active=!0,this.hasDiamond=!0;else this.type!==c.BOARD_TYPE.NORMAL&&this.type!==c.BOARD_TYPE.DROP||Math.random()>.7&&(this.diamondList[2].active=!0,this.hasDiamond=!0);this.hasDiamond&&this.setDiamondPos()}}},{key:"setDrop",value:function(){this.currDropFrame=0,this.posBeforeDrop.set(this.node.position)}},{key:"effectDrop",value:function(){if(this.currDropFrame<c.BOARD_DROP_FRAMES){for(var e=0;e<5;e++)this.diamondList[e].active=!1;if(this.springTop.active){this.springHelix.active=!1;var t=this.springTop.position;this.springTop.setPosition(t.x,t.y-c.BOARD_DROP_STEP,t.z)}D.set(this.node.position),D.y-=c.BOARD_DROP_STEP,this.node.setPosition(D),this.setCenterPos(),this.currDropFrame++}}},{key:"initDiamond",value:function(){for(var e=0;e<5;e++)this.diamondList[e]=o(this.diamondPrefab),this.node.parent.addChild(this.diamondList[e]),this.diamondList[e].active=!1}},{key:"setDiamondPos",value:function(){for(var e=new r,t=0;t<5;t++)this.diamondList[t].active&&(e.set(this.node.position),e.x+=1.4*(t-2),e.y+=c.BOARD_HEIGTH,this.diamondList[t].setPosition(e))}},{key:"hideDiamond",value:function(e){this.diamondList[e].active=!1}},{key:"checkDiamond",value:function(e){if(this.hasDiamond){for(var t=!0,i=0;i<5;i++)this.diamondList[i].active&&(t=!1,Math.abs(e-this.diamondList[i].position.x)<=c.DIAMOND_SCORE_AREA&&(c.game.ball.playDiamondParticle(this.diamondList[i].position),this.hideDiamond(i),c.game.addScore(c.DIAMOND_SCORE)));t&&(this.hasDiamond=!1)}}},{key:"effectDiamondRotate",value:function(){for(var e=0;e<5;e++){var t=this.diamondList[e].eulerAngles;this.diamondList[e].eulerAngles=new r(t.x,t.y+c.DIAMOND_ROTATE_STEP_Y,t.z)}}},{key:"initSpring",value:function(){this.springHelix=o(this.springHelixPrefab),this.springHelixOriginScale=this.springHelix.getScale(),this.springHelix.setScale(1.5,1,1.5),this.node.parent.addChild(this.springHelix),this.springHelix.active=!1,this.currSpringFrame=2*c.BOARD_SPRING_FRAMES,this.springTop=o(this.springTopPrefab),this.node.parent.addChild(this.springTop),this.springTop.active=!1;var e=this.node.position.clone();e.y+=(c.BOARD_HEIGTH+c.SPRING_HEIGHT)/2,this.springTop.setPosition(e),this.setSpringPos()}},{key:"setSpring",value:function(){this.currSpringFrame=0,this.setSpringPos(),this.springHelix.setScale(1.5,1,1.5),this.springHelix.active=!0,this.springTop.active=!0}},{key:"setSpringPos",value:function(){var e=this.node.position.clone();e.y+=c.BOARD_HEIGTH/2,this.springHelix.setPosition(e),(e=this.node.position.clone()).y+=(c.BOARD_HEIGTH+c.SPRING_HEIGHT)/2,this.springTop.setPosition(e)}},{key:"effectSpring",value:function(){var e=this.type===c.BOARD_TYPE.SPRINT?c.SPRING_HELIX_STEP_SPIRNT:c.SPRING_HELIX_STEP,t=this.type===c.BOARD_TYPE.SPRINT?c.SPRING_TOP_STEP_SPRINT:c.SPRING_TOP_STEP,i=this.springHelix.scale,s=this.springTop.position;this.currSpringFrame<c.BOARD_SPRING_FRAMES?(this.springHelix.setScale(i.x,i.y+e,i.z),this.springTop.setPosition(s.x,s.y+t,s.z),this.currSpringFrame++):this.currSpringFrame>=c.BOARD_SPRING_FRAMES&&this.currSpringFrame<2*c.BOARD_SPRING_FRAMES?(this.springHelix.setScale(i.x,i.y-e,i.z),this.springTop.setPosition(s.x,s.y-t,s.z),this.currSpringFrame++):this.springHelix.active=!1}},{key:"setBump",value:function(){this.currBumpFrame=0}},{key:"effectBump",value:function(){if(this.currBumpFrame<c.BOARD_BUMP_FRAMES){var e=this.node.position;this.node.setPosition(e.x,e.y+c.BOARD_BUMP_STEP[this.currBumpFrame],e.z),this.setCenterPos(),this.currBumpFrame++}}},{key:"initCenter",value:function(){this.center=o(this.centerPrefab),this.node.parent.addChild(this.center),this.center.active=!1}},{key:"setCenterPos",value:function(){var e=this.node.position.clone();e.y+=c.BOARD_HEIGTH/2,this.center.setPosition(e)}},{key:"initWave",value:function(){this.wave=o(this.wavePrefab),this.node.parent.addChild(this.wave),this.wave.active=!1,this.waveInner=o(this.wavePrefab),this.node.parent.addChild(this.waveInner),this.waveInner.active=!1,this.currWaveFrame=c.BOARD_WAVE_FRAMES,this.waveOriginScale.set(this.wave.scale)}},{key:"setWave",value:function(){if(this.type!=c.BOARD_TYPE.GIANT){this.currWaveFrame=0;var e=this.node.position.clone();e.y+=c.WAVE_OFFSET_Y,this.wave.setPosition(e),this.wave.setScale(this.waveOriginScale.clone()),this.wave.active=!0;var t=this.wave.getComponent(n).material.passes[0],i=t.getHandle("color"),s=cc.color("#dadada");s.a=127,t.setUniform(i,s),this.waveInner.setPosition(e),this.waveInner.setScale(this.waveOriginScale.clone())}}},{key:"effectWave",value:function(){if(this.currWaveFrame<c.BOARD_WAVE_FRAMES){if(this.currWaveFrame>=c.BOARD_WAVE_INNER_START_FRAMES){this.waveInner.active||(this.waveInner.active=!0);var e=this.waveInner.getComponent(n).material.passes[0],t=e.getHandle("color"),i=new l("#dadada");i.a=127-127*Math.sin(.05*this.currWaveFrame),e.setUniform(t,i);var s=this.waveInner.getScale();this.waveInner.setScale(s.x+c.BOARD_WAVE_INNER_STEP,s.y,s.z+c.BOARD_WAVE_INNER_STEP)}var r=this.wave.getComponent(n).material.passes[0],a=r.getHandle("color"),o=new l("#dadada");o.a=127-127*Math.sin(.1*this.currWaveFrame),r.setUniform(a,o);var p=this.waveInner.getScale();this.wave.setScale(p.x+c.BOARD_WAVE_STEP,p.y,p.z+c.BOARD_WAVE_STEP),this.currWaveFrame++}else this.wave.active=!1,this.waveInner.active=!1}},{key:"getHeight",value:function(){return this.type===c.BOARD_TYPE.DROP?c.BOARD_HEIGTH*c.BOARD_HEIGTH_SCALE_DROP:c.BOARD_HEIGTH}},{key:"getRadius",value:function(){return this.type===c.BOARD_TYPE.GIANT?c.BOARD_RADIUS*c.BOARD_RADIUS_SCALE_GIANT:c.BOARD_RADIUS}},{key:"setMove",value:function(e){var t=p.getDiffCoeff(e,1,10);return Math.random()*t>5}},{key:"effectMove",value:function(){if(this.isMoving){var e=this.node.getPosition().clone(),t=e.x;this.isMovingRight&&t<=c.SCENE_MAX_OFFSET_X?(t+=c.BOARD_MOVING_STEP,this.node.setPosition(t,e.y,e.z)):this.isMovingRight&&t>c.SCENE_MAX_OFFSET_X?this.isMovingRight=!1:!this.isMovingRight&&t>=-c.SCENE_MAX_OFFSET_X?(t-=c.BOARD_MOVING_STEP,this.node.setPosition(t,e.y,e.z)):!this.isMovingRight&&t<-c.SCENE_MAX_OFFSET_X&&(this.isMovingRight=!0),this.type===c.BOARD_TYPE.SPRING&&(this.springHelix.setPosition(this.node.position.x,this.springHelix.position.y,this.springHelix.position.z),this.springTop.setPosition(this.node.position.x,this.springTop.position.y,this.springTop.position.z)),this.setCenterPos(),this.hasDiamond&&this.setDiamondPos()}}},{key:"revive",value:function(){this.isActive=!1,this.isMoving=!1,this.type===c.BOARD_TYPE.DROP&&(this.currDropFrame=c.BOARD_DROP_FRAMES,this.node.setPosition(this.posBeforeDrop))}}]),t}(s),A=babelHelpers.applyDecoratedDescriptor(f.prototype,"diamondPrefab",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=babelHelpers.applyDecoratedDescriptor(f.prototype,"centerPrefab",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=babelHelpers.applyDecoratedDescriptor(f.prototype,"wavePrefab",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=babelHelpers.applyDecoratedDescriptor(f.prototype,"springTopPrefab",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=babelHelpers.applyDecoratedDescriptor(f.prototype,"springHelixPrefab",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=f))||v)),cc._RF.pop()}}})),System.register("project:///assets/script/game/game.ts",["cc","../data/constants.ts","./ball.ts","./board-manager.ts","./camera-ctrl.ts","./ui-manager.ts","./audio-manager.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A,R,g,m,S,E,T,D;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.instantiate,a=e.Prefab},function(e){o=e.Constants},function(e){n=e.Ball},function(e){l=e.BoardManager},function(e){c=e.CameraCtrl},function(e){p=e.UIManager},function(e){u=e.AudioManager}],execute:function(){cc._RF.push(window.module||{},"6b6999+5cFK4K47RCoawnB4","game"),T=i.ccclass,D=i.property,e("Game",(h=T("Game"),d=D(a),_=D(l),b=D(c),P=D(p),v=D(u),h((A=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"ballPref",R,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"boardManager",g,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"cameraCtrl",m,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"uiManager",S,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"audioManager",E,babelHelpers.assertThisInitialized(i)),i.state=o.GAME_STATE.READY,i.score=0,i.hasRevive=!1,i._ball=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"__preload",value:function(){o.game=this}},{key:"onLoad",value:function(){if(!this.ballPref)return console.log("There is no ball!!"),void(this.enabled=!1);var e=r(this.ballPref);e.parent=this.node.parent,this._ball=e.getComponent(n)}},{key:"start",value:function(){this.node.on(o.GAME_EVENT.RESTART,this.gameStart,this),this.node.on(o.GAME_EVENT.REVIVE,this.gameRevive,this)}},{key:"onDestroy",value:function(){this.node.off(o.GAME_EVENT.RESTART,this.gameStart,this),this.node.off(o.GAME_EVENT.REVIVE,this.gameRevive,this)}},{key:"resetGame",value:function(){this.state=o.GAME_STATE.READY,this._ball.reset(),this.cameraCtrl.reset(),this.boardManager.reset(),this.uiManager.showDialog(!0)}},{key:"gameStart",value:function(){this.audioManager.playSound(),this.uiManager.showDialog(!1),this.state=o.GAME_STATE.PLAYING,this.hasRevive=!1,this.score=0}},{key:"gameDie",value:function(){var e=this;this.audioManager.playSound(!1),this.state=o.GAME_STATE.PAUSE,this.hasRevive?this.gameOver():this.node.emit(o.GAME_EVENT.DYING,(function(){e.gameOver()}))}},{key:"gameOver",value:function(){this.state=o.GAME_STATE.OVER,this.audioManager.playSound(!1),this.resetGame()}},{key:"gameRevive",value:function(){var e=this;this.hasRevive=!0,this.state=o.GAME_STATE.READY,this.ball.revive(),this.scheduleOnce((function(){e.audioManager.playSound(),e.state=o.GAME_STATE.PLAYING}),1)}},{key:"addScore",value:function(e){this.score+=e,this.node.emit(o.GAME_EVENT.ADDSCORE,this.score)}},{key:"ball",get:function(){return this._ball}}]),t}(s),R=babelHelpers.applyDecoratedDescriptor(A.prototype,"ballPref",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=babelHelpers.applyDecoratedDescriptor(A.prototype,"boardManager",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=babelHelpers.applyDecoratedDescriptor(A.prototype,"cameraCtrl",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=babelHelpers.applyDecoratedDescriptor(A.prototype,"uiManager",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=babelHelpers.applyDecoratedDescriptor(A.prototype,"audioManager",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=A))||f)),cc._RF.pop()}}})),System.register("project:///assets/script/game/page-result.ts",["cc","../data/constants.ts","./update-value-label.ts","./revive.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A,R;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Node},function(e){a=e.Constants},function(e){o=e.UpdateValueLabel},function(e){n=e.Revive}],execute:function(){cc._RF.push(window.module||{},"31b007MqixM3YyJROFsTMEh","page-result"),A=i.ccclass,R=i.property,e("PageResult",(l=A("PageResult"),c=R({type:o}),p=R(r),u=R(r),h=R(r),l((_=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"scoreLabel",b,babelHelpers.assertThisInitialized(i)),i.targetProgress=0,babelHelpers.initializerDefineProperty(i,"nodeTips1",P,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"nodeTips2",v,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"result",f,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"init",value:function(){this.targetProgress=0,this.scoreLabel.playUpdateValue(this.targetProgress,this.targetProgress,0),this.scoreLabel.isPlaying=!1}},{key:"onEnable",value:function(){a.game.node.on(a.GAME_EVENT.HIDETIPS,this.hideTips,this),a.game.node.on(a.GAME_EVENT.ADDSCORE,this.addScore,this),a.game.node.on(a.GAME_EVENT.DYING,this.gameDie,this),this.showTips(!0),this.showResult(!1),this.init()}},{key:"start",value:function(){this.result.getComponent(n).pageResult=this}},{key:"onDisable",value:function(){a.game.node.off(a.GAME_EVENT.HIDETIPS,this.hideTips,this),a.game.node.off(a.GAME_EVENT.ADDSCORE,this.addScore,this)}},{key:"addScore",value:function(e){this.targetProgress=e;var t=Number(this.scoreLabel.string);this.scoreLabel.playUpdateValue(t,this.targetProgress,(this.targetProgress-t)/20)}},{key:"gameDie",value:function(e){this.showTips(!1),this.showResult(!0)}},{key:"showTips",value:function(e){this.nodeTips1.active=e,this.nodeTips2.active=e}},{key:"hideTips",value:function(){this.showTips(!1)}},{key:"showResult",value:function(e){this.result.active=e}}]),t}(s),b=babelHelpers.applyDecoratedDescriptor(_.prototype,"scoreLabel",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=babelHelpers.applyDecoratedDescriptor(_.prototype,"nodeTips1",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=babelHelpers.applyDecoratedDescriptor(_.prototype,"nodeTips2",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=babelHelpers.applyDecoratedDescriptor(_.prototype,"result",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=_))||d)),cc._RF.pop()}}})),System.register("project:///assets/script/game/page-start.ts",["cc","../data/constants.ts"],(function(e,t){var i,s,r,a,o,n;return e({_dec:void 0,_class:void 0}),{setters:[function(e){i=e._decorator,s=e.Component},function(e){r=e.Constants}],execute:function(){cc._RF.push(window.module||{},"75579oVThhNcJN3jNLu42YC","page-start"),n=i.ccclass,i.property,e("PageStart",(a=n("PageStart"),a(o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"gameStart",value:function(){r.game.node.emit(r.GAME_EVENT.RESTART),r.game.audioManager.playClip()}}]),t}(s))||o)),cc._RF.pop()}}})),System.register("project:///assets/script/game/revive.ts",["cc","../data/constants.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_,b,P,v,f,A,R,g,m;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_dec4:void 0,_dec5:void 0,_dec6:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_descriptor3:void 0,_descriptor4:void 0,_descriptor5:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.SpriteComponent,a=e.WidgetComponent,o=e.LabelComponent},function(e){n=e.Constants}],execute:function(){cc._RF.push(window.module||{},"37e87RwLXtA5LwGn6Zuq48u","revive"),g=i.ccclass,m=i.property,e("Revive",(l=g("Revive"),c=m(a),p=m(o),u=m({type:o}),h=m({type:o}),d=m(r),l((b=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r)))).closeCb=null,babelHelpers.initializerDefineProperty(i,"wgMenu",P,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"historyLabel",v,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"scoreLabel",f,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"progressLabel",A,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"spCountDown",R,babelHelpers.assertThisInitialized(i)),i.pageResult=null,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onEnable",value:function(){this.show()}},{key:"show",value:function(){var e=n.game.score;this.scoreLabel.string=e.toString(),n.MAX_SCORE<e&&(n.MAX_SCORE=e),this.historyLabel.string=n.MAX_SCORE.toString(),this.countDownTime=5,this.progressLabel.string=this.countDownTime+"",this.currentTime=0,this.spCountDown.fillRange=1,this.isCountDowning=!0}},{key:"onBtnReviveClick",value:function(){this.isCountDowning=!1,n.game.audioManager.playClip(),n.game.node.emit(n.GAME_EVENT.REVIVE),this.pageResult.showResult(!1)}},{key:"onBtnSkipClick",value:function(){n.game.audioManager.playClip(),this.isCountDowning=!1,n.game.gameOver()}},{key:"update",value:function(e){if(this.isCountDowning){this.currentTime+=e;var t=this.countDownTime-this.currentTime;this.progressLabel.string=Math.ceil(t)+"",t<=0&&(t=0,this.isCountDowning=!1,this.onBtnSkipClick());var i=t/this.countDownTime;this.spCountDown.fillRange=i}}}]),t}(s),P=babelHelpers.applyDecoratedDescriptor(b.prototype,"wgMenu",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=babelHelpers.applyDecoratedDescriptor(b.prototype,"historyLabel",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=babelHelpers.applyDecoratedDescriptor(b.prototype,"scoreLabel",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=babelHelpers.applyDecoratedDescriptor(b.prototype,"progressLabel",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=babelHelpers.applyDecoratedDescriptor(b.prototype,"spCountDown",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=b))||_)),cc._RF.pop()}}})),System.register("project:///assets/script/game/ui-manager.ts",["cc","../data/constants.ts"],(function(e,t){var i,s,r,a,o,n,l,c,p,u,h,d,_;return e({_dec:void 0,_dec2:void 0,_dec3:void 0,_class:void 0,_class2:void 0,_descriptor:void 0,_descriptor2:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.Component,r=e.Node},function(e){a=e.Constants}],execute:function(){cc._RF.push(window.module||{},"4becfUEfe1C2prK7h8zxNvz","ui-manager"),d=i.ccclass,_=i.property,e("UIManager",(o=d("UIManager"),n=_(r),l=_(r),o((p=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r))),babelHelpers.initializerDefineProperty(i,"pageStart",u,babelHelpers.assertThisInitialized(i)),babelHelpers.initializerDefineProperty(i,"pageResult",h,babelHelpers.assertThisInitialized(i)),i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"onLoad",value:function(){a.game.uiManager=this}},{key:"start",value:function(){this.pageResult.active=!1}},{key:"showDialog",value:function(e){this.pageResult.active=!e,this.pageStart.active=e}}]),t}(s),u=babelHelpers.applyDecoratedDescriptor(p.prototype,"pageStart",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=babelHelpers.applyDecoratedDescriptor(p.prototype,"pageResult",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),c=p))||c)),cc._RF.pop()}}})),System.register("project:///assets/script/game/update-value-label.ts",["cc"],(function(e,t){var i,s,r,a,o;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.LabelComponent}],execute:function(){cc._RF.push(window.module||{},"02566VN0PhN8o7NqZg0WyFs","update-value-label"),o=i.ccclass,i.property,e("UpdateValueLabel",(r=o("UpdateValueLabel"),r(a=function(e){function t(){var e,i;babelHelpers.classCallCheck(this,t);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return(i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(t)).call.apply(e,[this].concat(r)))).isPlaying=!1,i.startVal=0,i.endVal=0,i.diffVal=0,i.currTime=0,i.changingTime=0,i}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"start",value:function(){}},{key:"playUpdateValue",value:function(e,t,i){this.startVal=e,this.endVal=t,this.diffVal=this.endVal-this.startVal,this.currTime=0,this.changingTime=i,this.string=e.toString(),this.isPlaying=!0}},{key:"update",value:function(e){if(this.isPlaying){if(this.currTime<this.changingTime){this.currTime+=e;var t=this.startVal+parseInt((this.currTime/this.changingTime*this.diffVal).toString());return t<this.startVal?t=this.startVal:t>this.endVal&&(t=this.endVal),void(this.string="".concat(t))}this.string="".concat(this.endVal),this.isPlaying=!1}}}]),t}(s))||a)),cc._RF.pop()}}})),System.register("project:///assets/script/utils/pool-manager.ts",["cc"],(function(e,t){var i,s,r,a,o,n;return e({_dec:void 0,_class:void 0,_temp:void 0}),{setters:[function(e){i=e._decorator,s=e.instantiate,r=e.NodePool}],execute:function(){cc._RF.push(window.module||{},"f92c3xOcsdMEKh7W/84QPrD","pool-manager"),n=i.ccclass,i.property,e("PoolManager",(a=n("PoolManager"),a(o=function(){function e(){babelHelpers.classCallCheck(this,e),this.dictPool={},this.dictPrefab={}}return babelHelpers.createClass(e,[{key:"getNode",value:function(e,t){var i=e.data.name;this.dictPrefab[i]=e;var a=null;if(this.dictPool.hasOwnProperty(i)){var o=this.dictPool[i];a=o.size()>0?o.get():s(e)}else{var n=new r;this.dictPool[i]=n,a=s(e)}return a.parent=t,a}},{key:"putNode",value:function(e){var t=e.name,i=null;this.dictPool.hasOwnProperty(t)?i=this.dictPool[t]:(i=new cc.NodePool,this.dictPool[t]=i),i.put(e)}},{key:"clearPool",value:function(e){this.dictPool.hasOwnProperty(e)&&this.dictPool[e].clear()}}],[{key:"instance",get:function(){return this._instance?this._instance:(this._instance=new e,this._instance)}}]),e}())||o)),cc._RF.pop()}}})),System.register("project:///assets/script/utils/utils.ts",["cc"],(function(e,t){var i;return{setters:[function(e){i=e._decorator}],execute:function(){cc._RF.push(window.module||{},"dddce/2a/tOSLUiRKNMAQVd","utils"),i.ccclass,i.property,e("utils",{getDiffCoeff:function(e,t,i){return(i*e+1)/(1*e+((i+1)/t-1))},getRandomInt:function(e,t){var i=Math.random()*(t-e+1)+e;return Math.floor(i)}}),cc._RF.pop()}}}))}}}));
